# ============================================================================
# ENVIRONMENT CONFIGURATION TEMPLATE
# ============================================================================
# Copy this file to .env and configure for your environment.
#
# PROFILES:
#   - local:   Local development (IDE, mvn spring-boot:run)
#   - dev:     Docker Compose local deployment
#   - staging: QA/Acceptance testing (production-like)
#   - prod:    Production deployment (Jelastic/Infomaniak)
# ============================================================================

# ============================================================================
# 1. DATABASE CONFIGURATION
# ============================================================================
# PostgreSQL connection settings used by docker-compose and backend service.

# Database name
DB_NAME=spring_db

# Database credentials (CHANGE IN PRODUCTION!)
DB_ADMIN_USER=spring_user
DB_ADMIN_PW=secure_password

# Database port (external mapping)
DB_PORT=5432

# Database host
#   - local/dev: "db" (Docker service name) or "localhost"
#   - staging/prod: Your PostgreSQL server hostname
DB_HOST=db

# Connection pool settings (optional, has defaults per profile)
# DB_POOL_SIZE=20
# DB_POOL_MIN_IDLE=5

# ============================================================================
# 2. KEYCLOAK CONFIGURATION
# ============================================================================
# Identity provider settings for OAuth2/OIDC authentication.

# Keycloak admin credentials (CHANGE IN PRODUCTION!)
KC_ADMIN=admin
KC_ADMIN_PASSWORD=admin

# Keycloak external port (docker-compose maps internal 8080 to this)
KC_PORT=9000

# Realm name (must match template-realm.json)
KC_REALM=template-realm

# OAuth2 client ID (must match template-realm.json)
KC_CLIENT_ID=template-gateway

# OAuth2 client secret (MUST MATCH template-realm.json!)
# Generate a new secret in production: openssl rand -base64 32
KC_CLIENT_SECRET=CHANGE_ME_IN_PRODUCTION

# Keycloak public hostname URLs
#   - local/dev: http://localhost:${KC_PORT}
#   - staging/prod: https://auth.your-domain.jcloud.ik-server.com
KC_HOSTNAME_URL=http://localhost:${KC_PORT}
KC_HOSTNAME_ADMIN_URL=http://localhost:${KC_PORT}

# Keycloak issuer URL (used by backend to validate tokens)
#   - local: http://localhost:9000/realms/template-realm
#   - dev:   http://keycloak:8080/realms/template-realm
#   - staging/prod: https://auth.your-domain.jcloud.ik-server.com/realms/template-realm
# KEYCLOAK_ISSUER=http://localhost:9000/realms/template-realm

# ============================================================================
# 3. GATEWAY CONFIGURATION
# ============================================================================
# BFF Gateway (Spring Cloud Gateway) settings.

# Gateway external port
GW_PORT=8080

# Active Spring profile
#   - local:   For IDE/mvn spring-boot:run (localhost defaults)
#   - dev:     For Docker Compose (Docker service names)
#   - staging: For QA (env vars required, no defaults)
#   - prod:    For production (env vars required, HTTPS)
# SPRING_PROFILES_ACTIVE=dev

# URL scheme (http or https)
#   - local/dev: http
#   - staging/prod: https
SCHEME=http

# Session cookie secure flag
#   - local/dev: false (HTTP)
#   - staging/prod: true (HTTPS required)
COOKIE_SECURE=false

# Service hostnames (used by gateway to connect to other services)
#   - local: localhost
#   - dev:   Docker service names (keycloak, backend, gateway)
#   - staging/prod: Your actual hostnames
# KEYCLOAK_HOST=keycloak
# BACKEND_HOST=backend
# GATEWAY_HOST=gateway

# Service ports (internal container ports)
# KEYCLOAK_PORT=8080
# BACKEND_PORT=8081
# GATEWAY_PORT=8080

# Logging levels (optional)
# LOG_LEVEL_ROOT=INFO
# LOG_LEVEL_SECURITY=INFO
# LOG_LEVEL_WEB=INFO
# LOG_LEVEL_ADDONS=INFO

# ============================================================================
# 4. BACKEND CONFIGURATION
# ============================================================================
# Spring Boot backend (Resource Server) settings.

# Backend application port (internal)
BCK_APP_PORT=8081

# Backend management/actuator port (internal)
BCK_MGMT_PORT=8082

# Server port (used by Spring Boot)
# SPRING_SERVER_PORT=8081
# MANAGEMENT_SERVER_PORT=8082

# CORS allowed origins
#   - local/dev: http://localhost:5173,http://localhost:3000
#   - staging/prod: https://your-frontend-domain.jcloud.ik-server.com
# CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# Admin password (CHANGE IN PRODUCTION!)
# ADMIN_PASSWORD=localpassword

# Database connection (alternative to individual DB_* vars)
# SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/spring_db
# SPRING_DATASOURCE_USERNAME=spring_user
# SPRING_DATASOURCE_PASSWORD=secure_password

# ============================================================================
# 5. FRONTEND CONFIGURATION
# ============================================================================
# React/Vite frontend settings.

# Frontend external port (defaults to 80)
FE_PORT=80

# ============================================================================
# 6. JELASTIC/INFOMANIAK PRODUCTION OVERRIDES
# ============================================================================
# Uncomment and configure these for production deployment.
# Replace "myapp" with your actual Jelastic environment name.

# --- Required for production ---
# SPRING_PROFILES_ACTIVE=prod
# SCHEME=https
# COOKIE_SECURE=true

# --- Keycloak ---
# KC_HOSTNAME_URL=https://auth.myapp.jcloud.ik-server.com
# KC_HOSTNAME_ADMIN_URL=https://auth.myapp.jcloud.ik-server.com
# KEYCLOAK_ISSUER=https://auth.myapp.jcloud.ik-server.com/realms/template-realm
# KC_CLIENT_SECRET=<generate-new-secret>

# --- Gateway ---
# KEYCLOAK_HOST=auth.myapp.jcloud.ik-server.com
# KEYCLOAK_PORT=443
# BACKEND_HOST=backend.myapp.jcloud.ik-server.com
# BACKEND_PORT=8081
# GATEWAY_HOST=myapp.jcloud.ik-server.com
# GATEWAY_PORT=443

# --- Backend ---
# SPRING_DATASOURCE_URL=jdbc:postgresql://<db-host>:5432/spring_db
# SPRING_DATASOURCE_USERNAME=<db-user>
# SPRING_DATASOURCE_PASSWORD=<db-password>
# CORS_ALLOWED_ORIGINS=https://myapp.jcloud.ik-server.com
# ADMIN_PASSWORD=<secure-admin-password>

# --- Database (Jelastic managed) ---
# DB_HOST=<jelastic-db-host>
# DB_NAME=spring_db
# DB_ADMIN_USER=<db-user>
# DB_ADMIN_PW=<db-password>
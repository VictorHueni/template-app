# ========================================
# PRODUCTION PROFILE
# ========================================
# This profile should be activated in production environments
# Usage: java -jar app.jar --spring.profiles.active=prod
# ALL sensitive values MUST be provided via environment variables

# ========================================
# 1. DATABASE CONFIGURATION
# ========================================
# REQUIRED: Must be provided via environment variables
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Connection Pool (HikariCP) - optimized for production
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE:20}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN_IDLE:5}
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ========================================
# 2. JPA/HIBERNATE CONFIGURATION
# ========================================
# NEVER use 'update' or 'create-drop' in production
# Use Flyway/Liquibase for schema migrations
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.show_sql=false
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.open-in-view=false

# SQL Initialization
spring.sql.init.mode=never

# ========================================
# 3. WEB SERVER CONFIGURATION
# ========================================
server.port=${SERVER_PORT:8080}
server.servlet.context-path=/api

# Compression (optimize bandwidth)
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# ========================================
# 4. SECURITY CONFIGURATION
# ========================================
# REQUIRED: CORS must be provided via environment variable
cors.allowed.origins=${CORS_ALLOWED_ORIGINS:https://yourdomain.com}

# REQUIRED: Admin credentials via environment variables
admin.username=${ADMIN_USERNAME:admin}
admin.password=${ADMIN_PASSWORD}

# Cookie secure (OVERRIDE to true in production)
server.servlet.session.cookie.secure=true

# ========================================
# 5. ACTUATOR CONFIGURATION
# ========================================
# Production: Separate management port for network-level isolation
# Actuator endpoints available at http://localhost:8081/management/*
# This allows firewall rules to block external access to actuator
management.server.port=${MANAGEMENT_SERVER_PORT:8081}
management.server.base-path=/
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.endpoint.health.probes.enabled=true
# Info endpoint contributors
# Security: Disable env/java/os info contributors to prevent information leakage
management.info.env.enabled=false
management.info.java.enabled=false
management.info.os.enabled=false
# Only expose build version and git commit for release traceability
management.info.build.enabled=true
management.info.git.enabled=true
management.info.git.mode=simple

# ========================================
# 6. LOGGING CONFIGURATION
# ========================================
# Minimal logging in production (WARN level)
logging.level.root=WARN
logging.level.com.example.demo=INFO
logging.level.org.springframework=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN
logging.level.org.springframework.boot.actuate=WARN
logging.level.org.hibernate=WARN
# logging.level.org.hibernate.SQL=WARN (no SQL logging in prod)
# logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
# logging.level.org.springframework.jdbc.core=WARN

# Testcontainers (not applicable in production)
# logging.level.org.testcontainers=WARN
# logging.level.tc=WARN

# Log pattern (include correlation ID if using distributed tracing)
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# Log to file (optional - use centralized logging like ELK stack instead)
# logging.file.name=/var/log/demo-app/application.log
# logging.file.max-size=10MB
# logging.file.max-history=30

# ========================================
# 7. ERROR HANDLING
# ========================================
# NEVER expose details to clients
server.error.include-stacktrace=never
server.error.include-message=never
server.error.include-binding-errors=never

# ========================================
# 8. TESTCONTAINERS CONFIGURATION
# ========================================
# Not applicable in production

